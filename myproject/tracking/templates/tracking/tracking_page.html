{% extends 'layout.html' %}

{% block title %}
    FitNova - Tracker
{% endblock %}

{% block content %}
  <div class="user">
    <div class="news">
      <h2>Fitness Tracker</h2>

      <div class="note">

        <!-- Unit Selector -->
        <div>
          <h3>
            Units:
            <select id="unit-select" onchange="switchUnits()">
              <option value="metric">Metric (kg / cm)</option>
              <option value="imperial">Imperial (lbs / ft+in)</option>
            </select>
          </h3>
        </div>

        <!-- Metric Inputs -->
        <div id="metric-inputs">
          <h3>Weight (kg): <input type="number" id="weight" min="0" value="0"></h3>
          <h3>Height (cm): <input type="number" id="height" min="0" value="0"></h3>
        </div>

        <!-- Imperial Inputs -->
        <div id="imperial-inputs" style="display:none;">
          <h3>Weight (lbs): <input type="number" id="weight-lbs" min="0" value="0"></h3>
          <h3>
            Height:
            <input type="number" id="height-ft" min="0" value="0" style="width:60px;"> ft
            <input type="number" id="height-in" min="0" value="0" style="width:60px;"> in
          </h3>
        </div>

        <div class="bmi-display">
          <h3>Your BMI: <span id="bmi">0</span></h3>
          <h4>Status: <span id="bmi-status">N/A</span></h4>
        </div>

        <div class="delete">
          <button onclick="calculateBMI()">Calculate BMI</button>
          <button onclick="resetBMI()">Reset</button>
        </div>
      </div>
    </div>
  </div>

  <script>
    function switchUnits() {
      const unit = document.getElementById("unit-select").value;

      if (unit === "metric") {
        document.getElementById("metric-inputs").style.display = "block";
        document.getElementById("imperial-inputs").style.display = "none";
      } else {
        document.getElementById("metric-inputs").style.display = "none";
        document.getElementById("imperial-inputs").style.display = "block";
      }

      resetBMI();
    }

    function calculateBMI() {
      const unit = document.getElementById("unit-select").value;
      let bmi = 0;

      if (unit === "metric") {
        const weight = parseFloat(document.getElementById("weight").value);
        const heightCm = parseFloat(document.getElementById("height").value);

        if (!weight || !heightCm || heightCm <= 0) {
          alert("Please enter valid height and weight values.");
          return;
        }

        const heightM = heightCm / 100;
        bmi = weight / (heightM * heightM);

      } else {
        const weightLbs = parseFloat(document.getElementById("weight-lbs").value);
        const heightFt = parseFloat(document.getElementById("height-ft").value);
        const heightIn = parseFloat(document.getElementById("height-in").value);

        if (!weightLbs || (!heightFt && !heightIn)) {
          alert("Please enter valid height and weight values.");
          return;
        }

        const totalInches = (heightFt * 12) + heightIn;
        bmi = (weightLbs / (totalInches * totalInches)) * 703;
      }

      bmi = bmi.toFixed(1);
      document.getElementById("bmi").textContent = bmi;

      let status = "";
      if (bmi < 18.5) status = "Underweight";
      else if (bmi < 25) status = "Normal weight";
      else if (bmi < 30) status = "Overweight";
      else status = "Obese";

      document.getElementById("bmi-status").textContent = status;
    }

    function resetBMI() {
      document.getElementById("weight").value = 0;
      document.getElementById("height").value = 0;

      document.getElementById("weight-lbs").value = 0;
      document.getElementById("height-ft").value = 0;
      document.getElementById("height-in").value = 0;

      document.getElementById("bmi").textContent = "0";
      document.getElementById("bmi-status").textContent = "N/A";
    }
  </script>
{% endblock %}
